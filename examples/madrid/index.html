<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js effects - Madrid</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			canvas {
				position: fixed;
				top: 0;
				left:0;
				width: 100vw;
				height: 100vh;
			}
		</style>

		

	</head>
	<body>
		<canvas></canvas>
	   <script type="module">

			import { THREE, attachEffects, effectLib } from "../../dist/three-effects.js";
			import { WEBVR } from "../WebVR.js";
			import load from "./src/loader.js";
			import initScene from "./src/index.js";
			
			var camera, scene, renderer;

			load({
				"venus_model": "./assets/venus/index.obj",
				"venus_diffuse": "./assets/venus/diffuse.jpg",
				"venus_normals": "./assets/venus/normals.png",
				"venus_material": "./assets/venus/arg.png",

				"column_model": "./assets/column/index.obj",
				"column_diffuse": "./assets/column/diffuse.jpg",
				"column_normals": "./assets/column/normals.png",
				
				"ground_diffuse": "./assets/ground/diffuse.jpg",
				"ground_normals": "./assets/ground/normals.png",
				"ground_material": "./assets/ground/arg.png",
				
			}, function(pc){
				console.log(Math.floor(pc * 100) + "%");
			}).then(init);
			
			function init(assets) {
				console.log(assets);
				return;

				var canvas = document.querySelector( 'canvas' );

				
				if(window.location.hash === "#multiview") {

					var context = canvas.getContext( 'webgl2', { antialias: false, xrCompatible: true } );

					renderer = new THREE.WebGLRenderer( { canvas: canvas, context: context } );

				} else {
				
					renderer = new THREE.WebGLRenderer( { canvas: canvas, antialias: false } );

				}

				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );

				renderer.vr.enabled = true;
				//

				camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 50 );
				camera.position.z = 4;

				
				// Our scene
				scene = new THREE.Scene();
				

				onWindowResize();
				window.addEventListener( 'resize', onWindowResize, false );

				initScene(renderer, scene);

				document.body.appendChild( WEBVR.createButton( renderer ) );
				
				animate();
			}

			

			function onWindowResize() {

				var aspect = window.innerWidth / window.innerHeight;
				camera.aspect = aspect;
				camera.updateProjectionMatrix();

				var dpr = renderer.getPixelRatio();
				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function render () {
				
				renderer.render( scene, camera );

			}

			function animate() {

				renderer.setAnimationLoop( render );

			}

		</script>

	</body>
</html>